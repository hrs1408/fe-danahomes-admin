<div class="user-form-page">
  <div class="page-header">
    <h1>{{ isEdit ? 'Chỉnh sửa người dùng' : 'Thêm người dùng mới' }}</h1>
  </div>

  <nz-card>
    <form nz-form [formGroup]="userForm" (ngSubmit)="onSubmit()">
      <!-- Thông tin tài khoản -->
      <nz-form-item>
        <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired>Email</nz-form-label>
        <nz-form-control [nzSm]="14" [nzXs]="24" [nzErrorTip]="emailErrorTpl">
          <input nz-input formControlName="email" placeholder="Nhập email" />
          <ng-template #emailErrorTpl let-control>
            <ng-container *ngIf="control.hasError('required')">Vui lòng nhập email!</ng-container>
            <ng-container *ngIf="control.hasError('email')">Email không hợp lệ!</ng-container>
          </ng-template>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item *ngIf="!isEdit">
        <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired>Mật khẩu</nz-form-label>
        <nz-form-control [nzSm]="14" [nzXs]="24" [nzErrorTip]="passwordErrorTpl">
          <input nz-input type="password" formControlName="password" placeholder="Nhập mật khẩu" />
          <ng-template #passwordErrorTpl let-control>
            <ng-container *ngIf="control.hasError('required')">Vui lòng nhập mật khẩu!</ng-container>
            <ng-container *ngIf="control.hasError('minlength')">Mật khẩu phải có ít nhất 6 ký tự!</ng-container>
          </ng-template>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired>Vai trò</nz-form-label>
        <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Vui lòng chọn vai trò!">
          <nz-select formControlName="user_role" nzPlaceHolder="Chọn vai trò">
            <nz-option nzValue="supper_admin" nzLabel="Super Admin"></nz-option>
            <nz-option nzValue="admin" nzLabel="Admin"></nz-option>
            <nz-option nzValue="user" nzLabel="User"></nz-option>
          </nz-select>
        </nz-form-control>
      </nz-form-item>

      <!-- Thông tin cá nhân -->
      <nz-divider nzText="Thông tin cá nhân"></nz-divider>

      <div formGroupName="user_information">
        <nz-form-item>
          <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired>Họ tên</nz-form-label>
          <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Vui lòng nhập họ tên!">
            <input nz-input formControlName="full_name" placeholder="Nhập họ tên" />
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired>Số điện thoại</nz-form-label>
          <nz-form-control [nzSm]="14" [nzXs]="24" nzErrorTip="Vui lòng nhập số điện thoại!">
            <input nz-input formControlName="phone_number" placeholder="Nhập số điện thoại" />
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label [nzSm]="6" [nzXs]="24">Địa chỉ</nz-form-label>
          <nz-form-control [nzSm]="14" [nzXs]="24">
            <input nz-input formControlName="address" placeholder="Nhập địa chỉ" />
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label [nzSm]="6" [nzXs]="24">Ngày sinh</nz-form-label>
          <nz-form-control [nzSm]="14" [nzXs]="24">
            <nz-date-picker formControlName="dob" nzFormat="dd/MM/yyyy"></nz-date-picker>
          </nz-form-control>
        </nz-form-item>
      </div>

      <!-- Buttons -->
      <nz-form-item>
        <nz-form-control [nzOffset]="6" [nzSm]="14" [nzXs]="24">
          <button nz-button nzType="primary" type="submit" [nzLoading]="loading">
            {{ isEdit ? 'Cập nhật' : 'Thêm mới' }}
          </button>
          <button nz-button nzType="default" (click)="onCancel()" style="margin-left: 8px">
            Hủy
          </button>
        </nz-form-control>
      </nz-form-item>
    </form>
  </nz-card>
</div>
